<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="components/bootstrap/docs/assets/css/bootstrap.css" />
    <style type="text/css">
        h2 {
            font-size : 50px;
        }
    </style>
</head>
<body>
<h2 data-marker="A">A</h2>
<h2 data-marker="B[2]">B</h2>
<h2 data-marker="B[3]">B</h2>
<h2 data-marker="C">C</h2>

<script src="../dm.js"></script>
<script>
    DM.add('A', function() {
        console.log('A');
        this.node.style.color = 'red';

        var dep_b = this.dependency('B');

        console.log('module data: ', dep_b.data);
        console.log('0 instance data: ', dep_b.instances[0].data);
        console.log('1 instance data: ', dep_b.instances[1].data);
    }, ['B', 'C']);

    DM.add('B', function() {
        console.log('B');
        this.wait(1000);
        this.node.style.color = 'blue';

        //save to module data
        !this.module.data.count && (this.module.data.count = 0);
        this.module.data.count++;

        //save to instance data
        this.data.next = this.node.nextElementSibling;
    });

    DM.add('C', function() {
        console.log('C');
        this.wait(500);
        this.node.style.color = 'green';
    });

    DM.go();
</script>
</body>
</html>
